/*************************************************************************
 *
 * VLOCITY, INC. CONFIDENTIAL
 * __________________
 *
 *  [2014] - [2020] Vlocity, Inc.
 *  All Rights Reserved.
 *
 * NOTICE:  All information contained herein is, and remains
 * the property of Vlocity, Inc. and its suppliers,
 * if any. The intellectual and technical concepts contained
 * herein are proprietary to Vlocity, Inc. and its suppliers and may be
 * covered by U.S. and Foreign Patents, patents in process, and are
 * protected by trade secret or copyright law. Dissemination of this
 * information and reproduction, modification or reverse-engineering
 * of this material, is prohibited unless prior written permission
 * is obtained from Vlocity, Inc.
 *
 * Build: v234.0.0
 */
import { getAllOmniscripts, getAllFileBasedOmniScripts } from "c/flexCardUtils";

let getAllOmniscriptsPromise;

const getAllOmniscriptsWrapper = isStandardRuntime => {
  if (getAllOmniscriptsPromise) {
    return getAllOmniscriptsPromise;
  }
  if (!isStandardRuntime) {
    return (getAllOmniscriptsPromise = getAllOmniscripts());
  }
  let getOSList1 = getAllOmniscripts();
  let getOSList2 = getAllFileBasedOmniScripts();
  getAllOmniscriptsPromise = new Promise(resolve => {
    Promise.all([getOSList1, getOSList2]).then(data => {
      let osList = [];
      if (data?.length) {
        osList = [...data[0]];
        if (data[1]?.length) {
          data[1].forEach(item => {
            let obj = { ...item };
            obj.isFileBased = true;
            osList.push(obj);
          });
        }
      }
      resolve(osList);
    });
  });
  return getAllOmniscriptsPromise;
};

export { getAllOmniscriptsWrapper };
