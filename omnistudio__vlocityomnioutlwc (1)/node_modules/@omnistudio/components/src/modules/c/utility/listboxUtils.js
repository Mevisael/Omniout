/*************************************************************************
 *
 * VLOCITY, INC. CONFIDENTIAL
 * __________________
 *
 *  [2014] - [2020] Vlocity, Inc.
 *  All Rights Reserved.
 *
 * NOTICE:  All information contained herein is, and remains
 * the property of Vlocity, Inc. and its suppliers,
 * if any. The intellectual and technical concepts contained
 * herein are proprietary to Vlocity, Inc. and its suppliers and may be
 * covered by U.S. and Foreign Patents, patents in process, and are
 * protected by trade secret or copyright law. Dissemination of this
 * information and reproduction, modification or reverse-engineering
 * of this material, is prohibited unless prior written permission
 * is obtained from Vlocity, Inc.
 *
 * Build: v234.0.0
 */
const ARROW_UP_KEY = "ArrowUp";
const UP_KEY = "Up";
const ARROW_DOWN_KEY = "ArrowDown";
const DOWN_KEY = "Down";

/**
 * Performs the scrolling for a listbox such that the user will always be able to view the listbox item for up
 * and down keyboard controls
 * @param {*} listboxNode
 * @param {*} nextItem
 * @param {String} selectedKey
 * @returns {void}
 */
export function listboxScrollUpDown(listboxNode, nextItem, selectedKey) {
  if (
    listboxNode &&
    nextItem &&
    listboxNode.scrollHeight > listboxNode.clientHeight
  ) {
    const scrollBottomValue = listboxNode.clientHeight + listboxNode.scrollTop;
    const itemBottomValue = nextItem.offsetTop + nextItem.offsetHeight;

    switch (selectedKey) {
      case ARROW_UP_KEY: // Flows down to UP_KEY
      case UP_KEY: {
        // Indicates item is at the top, user will be scrolled to the bottom
        if (itemBottomValue === 0) {
          listboxNode.scrollTop = listboxNode.scrollHeight;
        }
        // Indicates user is within the listbox and will scroll accordingly
        else if (itemBottomValue < scrollBottomValue) {
          listboxNode.scrollTop = itemBottomValue - listboxNode.clientHeight;
        } else if (nextItem.offsetTop > listboxNode.scrollTop) {
          listboxNode.scrollTop = nextItem.offsetTop;
        }
        break;
      }
      case ARROW_DOWN_KEY: // Flows down to DOWN_KEY
      case DOWN_KEY: {
        // Indicates user is within the listbox and will scroll accordingly
        if (itemBottomValue > scrollBottomValue) {
          listboxNode.scrollTop = itemBottomValue - listboxNode.clientHeight;
        }
        // Indicates user is at the bottom, user will be scrolled to the top
        else if (
          itemBottomValue !== 0 &&
          nextItem.offsetTop < listboxNode.scrollTop
        ) {
          listboxNode.scrollTop = 0;
        }
        break;
      }
      default: // Do nothing
    }
  }
}
